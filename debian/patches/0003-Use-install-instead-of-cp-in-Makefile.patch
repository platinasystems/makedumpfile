From: John Wright <jsw@debian.org>
Date: Mon, 18 Apr 2011 02:23:53 -0700
Subject: Use install instead of cp in Makefile

This patch also removes the automatic man-page munging (if the date and
version are incorrect in an upstream tarball, it's easier to patch it
than to keep track of old versions to restore in the clean target).
Finally, it changes the install target to copy the uncompressed man
page, so that dh_compress can compress it according to policy.
---
 Makefile |   20 +++++++-------------
 1 files changed, 7 insertions(+), 13 deletions(-)

diff --git a/Makefile b/Makefile
index 15c907e..fbbc726 100644
--- a/Makefile
+++ b/Makefile
@@ -39,22 +39,16 @@ $(OBJ_ARCH): $(SRC_ARCH)
 
 makedumpfile: $(SRC) $(OBJ_PART) $(OBJ_ARCH)
 	$(CC) $(CFLAGS) $(LDFLAGS) $(OBJ_PART) $(OBJ_ARCH) -o $@ $< -ldw -lelf -lz
-	echo .TH MAKEDUMPFILE 8 \"$(DATE)\" \"makedumpfile v$(VERSION)\" \"Linux System Administrator\'s Manual\" > temp.8
-	grep -v "^.TH MAKEDUMPFILE 8" makedumpfile.8 >> temp.8
-	mv temp.8 makedumpfile.8
-	gzip -c ./makedumpfile.8 > ./makedumpfile.8.gz
-	echo .TH MAKEDUMPFILE.CONF 5 \"$(DATE)\" \"makedumpfile v$(VERSION)\" \"Linux System Administrator\'s Manual\" > temp.5
-	grep -v "^.TH MAKEDUMPFILE.CONF 5" makedumpfile.conf.5 >> temp.5
-	mv temp.5 makedumpfile.conf.5
-	gzip -c ./makedumpfile.conf.5 > ./makedumpfile.conf.5.gz
 
 clean:
 	rm -f $(OBJ) $(OBJ_PART) $(OBJ_ARCH) makedumpfile makedumpfile.8.gz makedumpfile.conf.5.gz
 
 install:
-	cp makedumpfile ${DESTDIR}/bin
-	cp makedumpfile-R.pl ${DESTDIR}/bin
-	cp makedumpfile.8.gz ${DESTDIR}/usr/share/man/man8
-	cp makedumpfile.conf.5.gz ${DESTDIR}/usr/share/man/man5
-	cp makedumpfile.conf ${DESTDIR}/etc/makedumpfile.conf.sample
+	install -D -m755 makedumpfile ${DESTDIR}/usr/bin/makedumpfile
+	install -D -m755 makedumpfile-R.pl ${DESTDIR}/usr/bin/makedumpfile-R.pl
+	install -D -m644 makedumpfile.8 \
+		${DESTDIR}/usr/share/man/man8/makedumpfile.8
+	install -D -m644 makedumpfile.conf.5 \
+		${DESTDIR}/usr/share/man/man5/makedumpfile.conf.5
+	install -D -m644 makedumpfile.conf ${DESTDIR}/etc/makedumpfile.conf
 
-- 
